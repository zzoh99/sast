function getWidth(obj){var _w=0;for(var i=0;i<=obj.LastCol();i++){if(!obj.GetColHidden(i)){_w+=obj.GetColWidth(i);}}return _w;}function getCount(obj){var _cnt=0;var _w=0;var _option=true;for(var i=0;i<=obj.LastCol();i++){if(obj.GetColHidden(i)==0){_w+=obj.GetColWidth(i);if(_option&&obj.GetColWidth(i)==45){_cnt++;}else{_option=false;}}}return[_cnt,_w];}function fitWidth(obj,count){try{var scrollWidth=0;var content_height=0;$("#DIV_"+obj.id).find(".GMBodyMid table").each(function(){content_height+=$(this).height();});if($("#DIV_"+obj.id).find(".GMBodyMid").height()+1<content_height){scrollWidth=18;}var cnt=count;var objID=document.getElementById("DIV_"+obj.id);var space=0;var width1=($("#DIV_"+obj.id).parent().width()-scrollWidth)-space;var width2=width1-cnt*45;var width3=getWidth(obj);width3-=cnt*45;var str="";var value=0;var gap=0;var _final=0;for(var i=0;i<=obj.LastCol();i++){if(!obj.GetColHidden(i)){_final=i;}}for(var i=0;i<=obj.LastCol();i++){if(!obj.GetColHidden(i)){if(i==_final){gap=width1-value-1;obj.SetColWidth(i,gap);}else{if(--cnt<0){str+=Math.floor((obj.GetColWidth(i)*width2)/width3)+"\n";value+=Math.floor((obj.GetColWidth(i)*width2)/width3);obj.SetColWidth(i,Math.floor((obj.GetColWidth(i)*width2)/width3));}else{str+=45+"\n";value+=45;obj.SetColWidth(i,45);}}}}}catch(e){}}function sheetSizeRestore(obj){for(var i=0;i<=obj.LastCol();i++){if(!obj.GetColHidden(i)){obj.SetColWidth(i,sheetColumnWidth[obj.id][i]);}}}var sheetWidth={};var sheetColumnWidth={};var sheetCount={};function setSheetSize(obj,count,init){try{if(obj.GetVisible()==0){obj.SetVisible(1);}var objID=document.getElementById("DIV_"+obj.id);if(objID.clientWidth==0){return;}if(sheetWidth[obj.id]==undefined||sheetWidth[obj.id]==0){var ary=getCount(obj);if(count==undefined){sheetCount[obj.id]=ary[0];}else{sheetCount[obj.id]=count;}sheetWidth[obj.id]=ary[1];sheetColumnWidth[obj.id]=[];for(var i=0;i<=obj.LastCol();i++){sheetColumnWidth[obj.id][i]=obj.GetColWidth(i);}}objID.clientWidth<sheetWidth[obj.id]?sheetSizeRestore(obj):fitWidth(obj,sheetCount[obj.id]);}catch(e){alert(e);}}function clearSheetSize(obj){sheetCount[obj.id]=null;sheetWidth[obj.id]=null;}function getColMaxValue(mySheet,Col){var maxValue=0;for(i=1;i<=mySheet.RowCount();i++){if(maxValue<parseInt(mySheet.GetCellValue(i,Col))){maxValue=parseInt(mySheet.GetCellValue(i,Col));}}maxValue=maxValue+1;return maxValue;}function makeSkipCol(sobj,cols){var lc=sobj.LastCol();var colsArr=cols.split("|");var rtnStr="";for(var i=0;i<=lc;i++){if($.inArray(i+"",colsArr)==-1){rtnStr+="|"+i;}}return rtnStr.substring(1);}function makeHiddenSkipCol(sobj){var lc=sobj.LastCol();var colsArr=new Array();for(var i=0;i<=lc;i++){if(1==sobj.GetColHidden(i)||sobj.GetCellProperty(0,i,"Type")=="Status"||sobj.GetCellProperty(0,i,"Type")=="DelCheck"){colsArr.push(i);}}var rtnStr="";for(var i=0;i<=lc;i++){if($.inArray(i,colsArr)==-1){rtnStr+="|"+i;}}return rtnStr.substring(1);}function checkDateCtl2(message,message2,sCtl,eCtl){if(sCtl.value!=""&&eCtl.value!=""){if(sCtl.value>eCtl.value){alert(message+"\uc77c\uc790\uac00 "+message2+"\uc77c\uc790\ubcf4\ub2e4 \ud07d\ub2c8\ub2e4.");eCtl.value="";eCtl.focus();return false;}}return true;}function checkNMDate(mySheet,row,col,message,sColNm,eColNm){if((mySheet.ColSaveName(col)==sColNm||mySheet.ColSaveName(col)==eColNm)&&mySheet.GetCellValue(row,eColNm)!=""){if(mySheet.GetCellValue(row,sColNm)>mySheet.GetCellValue(row,eColNm)){alert(message+"\uc2dc\uc791\uc77c\uc790\uac00 "+message+"\uc885\ub8cc\uc77c\uc790\ubcf4\ub2e4 \ud07d\ub2c8\ub2e4.");mySheet.SetCellValue(row,eColNm,"");mySheet.SelectCell(row,eColNm);return;}}}function checkNMDate2(mySheet,row,col,message1,message2,sColNm,eColNm){if((mySheet.ColSaveName(col)==sColNm||mySheet.ColSaveName(col)==eColNm)&&mySheet.GetCellValue(row,eColNm)!=""){if(mySheet.GetCellValue(row,sColNm)>mySheet.GetCellValue(row,eColNm)){alert(message1+"\uc77c\uc790\uac00 "+message2+"\uc77c\uc790\ubcf4\ub2e4 \ud07d\ub2c8\ub2e4.");mySheet.SetCellValue(row,eColNm,"");mySheet.SelectCell(row,eColNm);return;}}}