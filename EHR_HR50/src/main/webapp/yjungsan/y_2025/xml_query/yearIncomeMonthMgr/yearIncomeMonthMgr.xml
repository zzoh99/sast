<?xml version="1.0" encoding="UTF-8"?>
<!--
	연간소득관리_월별
 -->
<root>

	<!-- 연간소득관리_월별 조회 -->
	<query id="selectYearIncomeMonthMgrList">
		<![CDATA[
			SELECT A.ENTER_CD, '0' AS DETAIL, C.WORK_YY, C.ADJUST_TYPE, C.SABUN, B.NAME, C.ORG_NM, REPLACE(#srchYm#,'-','') AS YM,
				   DECODE(PAY_MON,NULL,'','0','',PAY_MON) AS PAY_MON , 
				   DECODE(BONUS_MON,NULL,'','0','',BONUS_MON) AS BONUS_MON ,
				   DECODE(ETC_BONUS_MON,NULL,'','0','',ETC_BONUS_MON) AS ETC_BONUS_MON ,
				   DECODE(FRGN_TAX_PLUS_MON,NULL,'','0','',FRGN_TAX_PLUS_MON) AS FRGN_TAX_PLUS_MON ,
				   DECODE(INCOME_TAX_MON,NULL,'','0','',INCOME_TAX_MON) AS INCOME_TAX_MON ,
				   DECODE(INHBT_TAX_MON,NULL,'','0','',INHBT_TAX_MON) AS INHBT_TAX_MON ,
				   DECODE(RURAL_TAX_MON,NULL,'','0','',RURAL_TAX_MON) AS RURAL_TAX_MON ,
				   DECODE(EXMPT_TAX_MON,NULL,'','0','',EXMPT_TAX_MON) AS EXMPT_TAX_MON ,
				   DECODE(FRGN_MON,NULL,'','0','',FRGN_MON) AS FRGN_MON ,
				   DECODE(FRGN_NTAX_MON,NULL,'','0','',FRGN_NTAX_MON) AS FRGN_NTAX_MON ,
				   DECODE(PEN_MON,NULL,'','0','',PEN_MON) AS PEN_MON ,
				   DECODE(HEL_MON,NULL,'','0','',HEL_MON) AS HEL_MON ,
				   DECODE(EMP_MON,NULL,'','0','',EMP_MON) AS EMP_MON ,
				   DECODE(LABOR_MON,NULL,'','0','',LABOR_MON) AS LABOR_MON ,
				   DECODE(NOTAX_ABROAD_MON,NULL,'','0','',NOTAX_ABROAD_MON) AS NOTAX_ABROAD_MON ,
				   DECODE(NOTAX_WORK_MON,NULL,'','0','',NOTAX_WORK_MON) AS NOTAX_WORK_MON ,
				   DECODE(NOTAX_FOOD_MON,NULL,'','0','',NOTAX_FOOD_MON) AS NOTAX_FOOD_MON ,
				   DECODE(NOTAX_CAR_MON,NULL,'','0','',NOTAX_CAR_MON) AS NOTAX_CAR_MON ,
				   DECODE(NOTAX_TRAIN_MON,NULL,'','0','',NOTAX_TRAIN_MON) AS NOTAX_TRAIN_MON ,
				   DECODE(NOTAX_FORN_MON,NULL,'','0','',NOTAX_FORN_MON) AS NOTAX_FORN_MON ,
			   	   DECODE(NOTAX_BABY_MON,NULL,'','0','',NOTAX_BABY_MON) AS NOTAX_BABY_MON ,
			   	   DECODE(NOTAX_NIGHTDUTY_MON,NULL,'','0','',NOTAX_NIGHTDUTY_MON) AS NOTAX_NIGHTDUTY_MON ,
			   	   DECODE(NOTAX_REPORTER_MON,NULL,'','0','',NOTAX_REPORTER_MON) AS NOTAX_REPORTER_MON ,
			   	   DECODE(NOTAX_ETC_MON,NULL,'','0','',NOTAX_ETC_MON) AS NOTAX_ETC_MON ,
				   DECODE(ETC_MON1,NULL,'','0','',ETC_MON1) AS ETC_MON1 ,
				   DECODE(ETC_MON2,NULL,'','0','',ETC_MON2) AS ETC_MON2 ,
				   DECODE(ETC_MON3,NULL,'','0','',ETC_MON3) AS ETC_MON3 ,
				   DECODE(ETC_MON4,NULL,'','0','',ETC_MON4) AS ETC_MON4 ,
				   DECODE(STOCK_BUY_MON,NULL,'','0','',STOCK_BUY_MON) AS STOCK_BUY_MON ,
				   DECODE(STOCK_UNION_MON,NULL,'','0','',STOCK_UNION_MON) AS STOCK_UNION_MON ,
				   DECODE(NOTAX_RESEARCH_MON,NULL,'','0','',NOTAX_RESEARCH_MON) AS NOTAX_RESEARCH_MON,
				   NVL(PAY_MON,0) + NVL(BONUS_MON,0) + NVL(ETC_BONUS_MON,0) + NVL(STOCK_BUY_MON,0) + NVL(STOCK_UNION_MON,0) AS TOT_MON,	    
				   NVL(NOTAX_WORK_MON,0) + NVL(NOTAX_ABROAD_MON,0) + NVL(NOTAX_FOOD_MON,0) + NVL(NOTAX_CAR_MON,0) + NVL(NOTAX_FORN_MON,0) + NVL(NOTAX_RESEARCH_MON,0) + NVL(NOTAX_BABY_MON,0) + NVL(NOTAX_ETC_MON,0) AS NOTAX_TOT_MON,
				   DECODE(IMWON_RET_OVER_MON,NULL,'','0','',IMWON_RET_OVER_MON) AS IMWON_RET_OVER_MON,
				   A.MEMO AS MEMO
			  FROM TCPN813 A,  THRM100 B,  TCPN811 C
			 WHERE B.ENTER_CD = C.ENTER_CD
			   AND B.SABUN = C.SABUN
			   AND A.ENTER_CD(+) = C.ENTER_CD
			   AND A.SABUN(+) = C.SABUN
			   AND A.WORK_YY(+) = C.WORK_YY
			   AND A.ADJUST_TYPE(+) = C.ADJUST_TYPE
			   AND A.YM(+) 		 = REPLACE(#srchYm#,'-','') 
			   AND C.ENTER_CD    = #ssnEnterCd#
           	   AND C.WORK_YY  	 = SUBSTR(REPLACE(#srchYm#,'-',''),1,4)
           	   AND REGEXP_LIKE(C.ADJUST_TYPE, '^[1359]') -- 시뮬레이션 자료 등은 조회되지 않도록
        	   AND ( #srchAdjustType# IS NULL OR C.ADJUST_TYPE = #srchAdjustType# ) -- 조회조건 : 작업구분
		   	   AND ( C.SABUN	LIKE '%' || TRIM(#srchSbNm#) || '%' OR B.NAME LIKE '%' || TRIM(#srchSbNm#) || '%')
  		   	   AND DECODE('',#searchBizPlaceCd#,'A',F_CPN_YEA_BP_CD(C.ENTER_CD,C.WORK_YY,C.ADJUST_TYPE,C.SABUN)) = DECODE('',#searchBizPlaceCd#,'A',#searchBizPlaceCd#)
  		   	 ORDER BY C.ADJUST_TYPE, C.SABUN
		]]> 
	</query>

</root>